<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Index of {{path}}</title>
        <!---->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fomantic-ui/2.7.5/semantic.min.css" integrity="sha256-S4n5rcKkPwT9YZGXPue8OorJ7GCPxBA5o/Z0ALWXyHs=" crossorigin="anonymous" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/file-icon-vectors@1.0.0/dist/file-icon-square-o.min.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro">
        <link rel="stylesheet" href="style.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/fomantic-ui/2.7.5/semantic.min.js" integrity="sha256-x9fzgXT3ttK2cZF12FIafkDJzEqqLnaWcchT+Y/plJ4=" crossorigin="anonymous"></script>
        <script src="https://semantic-ui.com/javascript/library/tablesort.js"></script>
        <!---->
        <style>
            body > div { margin: 1em; }
            table.table { font-family: 'Source Code Pro', 'Courier New', monospace; }
            table.table tr td { white-space: nowrap; padding: .2em .7em !important; }
            table.table tr td:nth-child(5) { text-align: right; }
            #dlbox { background-color: #dedede; border-radius: .25em; padding: 1em; }
            code { background-color: #ccc; border-radius: .2em; padding: .25em; }
        </style>
        <script>
            (function() {
                $.tablesort.defaults.compare = function compare(a, b) {
                    if (a == "" || a == "Parent Directory") {
                        const direction = $("table.sortable").data("tablesort").direction;
                        
                        if (direction == "asc") {
                            return -1;
                        } else {
                            return 1;
                        }
                    }
                    
                    if (a < b) {
                        return -1;
                    }
                    if (a > b) {
                        return 1;
                    }

                    return 0;
                };
                
                $(document).ready(function() {
                    $("table.sortable").tablesort();
                })
            })();
        </script>
    </head>
    <body class="page-listing">
        <div class="ui main menu">
            <div class="header item">Welcome, {{user.Name}}@{{user.Provider}}</div>
            {{#if search_on}}
            <div class="item"><a href="{{base}}search"><i class="search icon"></i> Search</a></div>
            {{/if}}
            {{#if admin}}
            <div class="item"><a href="{{base}}admin">Admin Panel</a></div>
            {{/if}}
            <div class="item"><a href="{{base}}logout">Logout</a></div>
            <div class="right item">Powered by&nbsp;<a href="https://github.com/nektro/andesite" target="_blank">Andesite</a></div>
        </div>
        <div>
            <h1 class="ui header">Index of {{path}}</h1>
            <div class="ui divider"></div>
            <table class="ui sortable compact table">
                <thead>
                    <th class="collapsing no-sort"></th>
                    <th class="collapsing no-sort"></th>
                    <th class="collapsing">Name</th>
                    <th class="collapsing">Last Modified</th>
                    <th class="collapsing">Size</th>
                    <th class="no-sort"></th>
                </thead>
                <tbody>
                    <tr><td></td><td></td><td><a href="../">Parent Directory</a></td><td></td><td></td><td></td></tr>
                    {{#each files}}
                    <tr><td>{{add_i @index 1}}</td><td><span class="fiv-sqo fiv-icon-{{ext}}"></span></td><td><a href="{{url_name name}}">{{name}}</a></td><td>{{mod}}</td><td>{{size}}</td><td></td></tr>
                    {{/each}}
                </tbody>
            </table>
        </div>
        {{#if extras.user}}
        <div id="dlbox">
            <p>Download the contents of the entire folder using your passkey: <code>{{extras.user.PassKey}}</code> (<a href="{{base}}regen_passkey">Regenerate Key</a>)</p>
            <p><code>wget -m -np -c -R "index.html*" --user-agent "AndesiteUser/{{extras.user.PassKey}}" "{{host}}/files{{path}}"</code></p>
            <p><code>rclone copy --http-url="{{host}}/files{{path}}" :http: ./ -P --user-agent "AndesiteUser/{{extras.user.PassKey}}"</code></p>
        </div>
        {{/if}}
    </body>
</html>
